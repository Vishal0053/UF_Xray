rule Suspicious_Powershell_Strings {
  meta:
    description = "Detects suspicious PowerShell keywords often seen in malware"
  strings:
    $ps1 = "Invoke-Expression"
    $ps2 = "FromBase64String"
    $ps3 = "System.Management.Automation"
    $ps4 = "-EncodedCommand"
  condition:
    2 of ($ps*)
}

rule Suspicious_Executable_Patterns {
  meta:
    description = "Generic suspicious strings found in some malware"
  strings:
    $s1 = "cmd.exe"
    $s2 = "powershell"
    $s3 = "wscript"
    $s4 = "mshta"
  condition:
    any of ($s*)
}
